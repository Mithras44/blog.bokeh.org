<!doctype html>
<meta charset="utf-8">
<head>

<link rel="stylesheet" href="../../../../../static/normalize.css">
<link rel="stylesheet" href="../../../../../static/skeleton.css">
<link rel="stylesheet" href="../../../../../static/style.css">
<link rel="stylesheet" href="../../../../../static/gen/styles.css">
<link rel="stylesheet" href="../../../../../static/custom.css">
<link rel="stylesheet" href="../../../../../static/pygments.css">

<!-- Mobile Specific Metas
–––––––––––––––––––––––––––––––––––––––––––––––––– -->
<meta name="viewport" content="width=device-width, initial-scale=1">

<!-- FONT
–––––––––––––––––––––––––––––––––––––––––––––––––– -->
<link href="//fonts.googleapis.com/css?family=Raleway:400,300,600" rel="stylesheet" type="text/css">

<title>Creating A Live Dashboard with Bokeh | Bokeh Org</title>

</head>
<body>
    <div class="navbar-spacer"></div>
    <nav class="navbar">
      <div class="container">
        <ul class="navbar-list">
            <li class="navbar-item"><a class="navbar-link" href="/">Home</a></li>
            <li class="navbar-item"><a class="navbar-link" href="http://bokeh.pydata.org/en/latest">Documentation</a></li>
            <li class="navbar-item"><a class="navbar-link" href="/blog">Blog</a></li>
        </ul>
      </div>
    </nav>

    <div class="body-wrapper">
      
  <div class="blog-post">
    
  
    
  <div class="container">
    <div class="row">
      <div class="eleven columns">
        
      <div class="meta-bar">
        <h1>Creating A Live Dashboard with Bokeh</h1>
        <p class="meta">
          by
          
            <a href="https://twitter.com/usretx">Joshua Usry</a>
          
          on Monday, March 13, 2017
        </p>
      </div>
    
      </div>
    </div>
  </div>

  
  
    
      
  <div class="container">
    <div class="row">
      <div class="eleven columns">
        <div class="text-block text-block-default">
  <p>Recently, I completed a project creating an analytics dashboard for a client.
I used Bokeh for the visualizations and wanted to share my experiences.</p>
<h1>Overview</h1>
<p>I'd like to describe the dashboard I created and then talk about some of the
steps it took to create. You can see the finished product below:</p>
<div class="image"><center><img src="all_tiny.png"/></center></div><p>In the top left corner we have statistics for three servers with line graphs representing CPU, memory, and disk usage.  If any
graph has a reading above 75% it, its title, and its plot turn red like <a href="http://bokeh.pydata.org/en/latest/docs/gallery/box_annotation.html">this</a>.
When the readings drop, things go back to normal. Moving downward, we have two line graphs plotting users currently
connected to our system and how fast our system is processing their messages over time.  At the bottom is a live Google
Map of users in the field that are transmitting, with colors representing different user states.</p>
<p>On the top right we have various tables showing running processes, versioning, jar info, uptime, and open file statistics (when available).
Below that, we have an alerts area displaying faults, overflows, and server errors. The figures change to red when they exceed certain
parameters and the drop downs are shown as needed. Finally, we have the 'firehose' on the bottom right that's fed from tails of various logs
from two boxes, colored coded to keep it straight.  It's not shown in the photo, but the log scrolls fairly like a terminal, albeit quickly (my client said they wanted it
'for peace of mind', even though the logs fly by at light speed).</p>
<h4>Close Ups</h4>
<p>You can see some of the elements close up in the images below:</p>
<div class="image"><center><img src="server_graphs.png"/></center></div>
<div class="image"><center><img src="lines_gps.png"/></center></div>
<div class="image"><center><img src="alerts_procs.png"/></center></div><h4>Full Sized Shot</h4>
<p>And here is a shot showing the dahsboard updating over time:</p>
<div class="image"><center><img src="action.gif"/></center></div><h1>Development Strategy</h1>
<p>My game plan for the project was to create each module grouping (server stats, long line graphs, GPS, tables
firehose) separately and then fit them together in whatever way made the most visual sense.  I felt this approach allowed me
 to pay closer attention to the details of each module and adjust the over all app layout as needed without
much issue.   All modules are comprised of only two Bokeh elements, HTML divs (including the Google Map) and line graphs.
Periodic callbacks update everything, except the Google Map that hits a local Flask API periodically via Javascript instead.  I did this because at the time of writing there were some issues with Bokeh's GMapPlot (but that should be resolved in the next release).
Error handling was mostly concentrated to handling data from the various Bash commands used to source server stats and dealing with their output, expected or otherwise.</p>
<h1>Back End Setup</h1>
<p>I tried to stay with the "server app" design similar to those shown <a href="http://bokeh.pydata.org/en/latest/docs/gallery.html">here</a>
and kept my folder structure as prescribed <a href="http://bokeh.pydata.org/en/latest/docs/user_guide/server.html#directory-format">here</a>
to try and keep things simple, with all my Python in a common folder and a HTML file in a "templates" folder.  This was done so Bokeh's Tornado server would find the HTML file and use it as a template for the app.  I also used <a href="http://bokeh.pydata.org/en/latest/docs/user_guide/server.html#updating-from-threads">threads</a> and
<a href="http://bokeh.pydata.org/en/latest/docs/user_guide/server.html#updating-from-unlocked-callbacks">unlocked callbacks</a>
for pretty much every element in the app to keep things responsive.  The data for all modules is sourced from three daemonized <a href="https://docs.python.org/2/library/threading.html">threads</a>,
responsible for information from SSH, HTTP, and SQL.  They are started by server lifecycle hooks described <a href="http://bokeh.pydata.org/en/latest/docs/user_guide/server.html#lifecycle-hooks">here</a>, init when the server is launched, gather data from their respective source, and make it
availble to the dashboard.  And since the dashboard gets data from the a general cache, N users are able to share info cached from a single database, SSH, and HTTP connection.  Awesome.  This also allows the dashboard to scale nicely, especially with Tornado's help.</p>
<h1>Next Steps</h1>
<p>I didn't have enough time to give the dashboard a memory, so when you log in you can't see anything from previous runs.  My client didn't see this as a dealbreaker, having dedicated plasma screens and projectors for this kind of thing (with some instances showing months of cached data). But it's kind of problematic if anything should happen to those systems, or even the browsers on them.
To remedy this, I'd like to save data using locally to a SQlite database and initialize the dashboard with cached data from it to show a week or more of data.</p>

</div>
      </div>
    </div>
  </div>

    
  


    
    
    
    <div class="container">
      <div class="row">
        <div class="eight columns">
        
          <div class="nav-prev">
            <a href="../../../../../blog/2017/1/6/release-0-12-4/">Previous: Bokeh 0.12.4 Released</a>
          </div>
        
        
        </div>
      </div>
    </div>
  </div>

    </div>

    
    <div class="bottomsummary">
      <div class="container">
      </div>
    </div>
    

    
    <footer>
      <div class="container">
        <div class="row">
          <div class="four columns icon-bar">
            <a href="https://github.com/bokeh/bokeh/" title="Bokeh on GitHub"
              ><i class="fa fa-github"></i></a>
            <a href="https://github.com/bokeh/bokeh/issues/" title="Report Issues for Bokeh"
              ><i class="fa fa-bug"></i></a>
            <a href="https://twitter.com/BokehPlots" title="Find Bokeh on Twitter"
              ><i class="fa fa-twitter"></i></a>
            <a href="https://gitter.im/bokeh/bokeh" title="Chat on Gitter"
              ><i class="fa fa-comment"></i></a>
            <a href="https://github.com/bokeh/bokeh.github.io/tree/source/content/blog/dashboard/contents.lr" title="View source for this page"><i class="fa fa-code"></i></a>
          </div>
        </div>
      </div>
    </footer>
    

<!-- JS
================================================== -->
<script src="https://code.jquery.com/jquery-1.7.1.min.js"></script>

<!-- Google Analytics -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-27761864-7', 'pydata.org');
  ga('send', 'pageview');
</script>

</body>
